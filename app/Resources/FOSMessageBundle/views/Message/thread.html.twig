{% extends 'FOSMessageBundle::layout.html.twig' %}

{% block fos_message_content %}
<h3>{{ thread.subject }}</h3>
<div class="row">
    <div class="span9">
        {% for message in thread.messages %}
            <div class="well {{ thread.createdBy == message.sender ? 'starter-message' : '' }}">
                <div>
                    <p>
                        {% trans with {'%sender%': message.sender|e} from 'FOSMessageBundle' %}by{% endtrans %}
                    </p>
                    <p>
                        {% trans with {'%date%': message.createdAt|localizeddate} from 'FOSMessageBundle' %}on{% endtrans %}
                        ({{ message.createdAt|time_ago_in_words }})
                    </p>
                    {% if loop.first %}
                    <p>
                        <span class="pull-left">{{ 'To'|trans }}&nbsp;</span>
                        <ul class="unstyled pull-left">
                            {% for participant in thread.participants if participant != thread.createdBy %}
                                <li>{{ participant }}</li>
                            {% endfor %}
                        </ul>
                    </p>
                    {% endif %}
                </div>
                <div class="clearfix"></div>
                <div id="message_{{ message.id }}">
                    {{ message.body }}
                </div>
            </div>
        {% endfor %}
        <h4>{% trans from 'FOSMessageBundle' %}reply{% endtrans %}</h4>
        <form action="{{ url('fos_message_thread_view', {'threadId': thread.id}) }}" method="post" class="well form-horizontal">
            {{ form_widget(form, {'form_type': 'horizontal'}) }}
            <div class="control-group">
                <div class="controls">
                    <button type="submit" class="btn btn-primary"><i class="icon-envelope"></i> {{ 'Send'|trans }}</button>
                </div>
            </div>
        </form>
    </div>
    <div class="span3">
        {% include 'FOSMessageBundle:Message:sidebar_new.html.twig' %}
    </div>
</div>
{% endblock %}
